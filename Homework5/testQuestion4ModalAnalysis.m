% testQuestion4ModalAnalysis

% The Question4ModalAnalysis function is tested against the example
% provided by Miranda, MDOF Structures Part A, page 30-40
 
Cd = 5.5;
Ie = 1.0;
Hi = 12; % ft
Csm  = [0.0388;
        0.1131;
        0.1750;
        0.1750;
        0.1750];

mass = 100/386.0886; % mass units
stiffness = 31.54; % kips/in
nfloors = 5;
    
[F,V,Uxe,Ux,deltaXe,deltaX] = Question4ModalAnalysis(nfloors,mass,stiffness,Csm,Cd,Ie,Hi);
% Expected output:
% F =
% 
%     4.8566    3.4030    2.7751    1.8600    0.2632
%     4.4631    4.4570   -1.9852   -1.5454   -0.7061
%     3.7081    2.4344   -3.3402   -0.5761    0.9248
%     2.6527   -1.2686    1.0345    2.0240   -0.8498
%     1.3823   -4.0959    3.6346   -1.1055    0.5051
% 
% 
% V =
% 
%     4.8566   -4.0959    2.7751   -1.1055    0.2632
%     9.3198   -5.3645    0.7899    0.9185   -0.4429
%    13.0279   -2.9301   -2.5503    0.3424    0.4819
%    15.6805    1.5269   -1.5158   -1.2030   -0.3679
%    17.0629    4.9299    2.1189    0.6571    0.1372
% 
% 
% Uxe =
% 
%     1.9007   -0.1881    0.0513   -0.0124    0.0023
%     1.7467   -0.0583   -0.0367    0.0227   -0.0061
%     1.4512    0.1118   -0.0617   -0.0065    0.0080
%     1.0382    0.2047    0.0191   -0.0173   -0.0073
%     0.5410    0.1563    0.0672    0.0208    0.0043
% 
% 
% Ux =
% 
%    10.4538   -1.0347    0.2821   -0.0681    0.0125
%     9.6069   -0.3205   -0.2018    0.1247   -0.0334
%     7.9817    0.6150   -0.3396   -0.0355    0.0438
%     5.7099    1.1259    0.1052   -0.0952   -0.0402
%     2.9755    0.8597    0.3695    0.1146    0.0239
% 
% 
% deltaXe =
% 
%     0.0011   -0.0009    0.0006   -0.0002    0.0001
%     0.0021   -0.0012    0.0002    0.0002   -0.0001
%     0.0029   -0.0006   -0.0006    0.0001    0.0001
%     0.0035    0.0003   -0.0003   -0.0003   -0.0001
%     0.0038    0.0011    0.0005    0.0001    0.0000
% 
% 
% deltaX =
% 
%     0.0059   -0.0050    0.0034   -0.0013    0.0003
%     0.0113   -0.0065    0.0010    0.0011   -0.0005
%     0.0158   -0.0035   -0.0031    0.0004    0.0006
%     0.0190    0.0018   -0.0018   -0.0015   -0.0004
%     0.0207    0.0060    0.0026    0.0008    0.0002